---
title: "tashu : Analysis and Demand forecast for Public bicycles('Tashu') in Daejeon, South Korea"
author: "JiWon Min"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---
## 1. Introduction
 The public bicycle system is spreading globally as a green public transportation. In major cities around the world, public bicycle systems are leading to the effects of distribution of public transportation demand and the increase of citizens' momentum. Through analyzing the history of bicycle rental in a city, you can check the patterns of bicycle use by citizens. By getting the time for which amount of the bike rental is increasing, it is possible to obtain a proper bike relocation work time and prevent the bicycle imbalance in advance. And By getting the mainly used routes, It would be more easier to select the location for new bicycle stop. This package provides bike rental history data of public bicycle system called 'Tashu' in Daejeon, South Korea and analytic functions. Everyone can freely analyze patterns of bicycle use through Bicycle rental history, bicycle station information, weather data and Daejeon city festival data from 2013 to 2015. 


## 2. Data
1.    Tashu Data
: Bicycle rental history on Tashu from 2013 to 2015. Data is consisted of "RENT STATION, RENT DATE, RETURN STATION, RETURN DATE"
* tashu2013 : Rental history In 2013.
* tashu2014 : Rental history In 2014.
* tashu2015 : Rental history In 2015.
* tashuDataFor3year : Rental history from 2013 to 2015.

```{r}
load(file = "../data/tashu2013.rda")
head(tashu2013, n = 5)
```

2.    Tashu Station Data
: By 2014 there were 144 bicycle stations and a new one in 2015, currently operating 244 stations. In this study, only the existing data of 144 stop stations are considered. Data is consisted of "NUM(Number of station), KIOSKNUM(Number of Kiosk), DISTRICT(District where Station is located), Name(Name of station), LOCATION(Location of station), NUMOFBIKE_RACK(Number of Bike rack), GEODATA_lat(Latitude of station), GEODATA_lon(Longitude of station)"

* tashuStationData : data of 144 Stations on Tashu system. 
```{r}
load(file = "../data/tashuStationData.rda")
head(tashuStationData, n = 5)
```

3.    Weather Data
: Weather Data In Daejeon from 2013 to 2015. Data is consisted of "datetime, temperature, rainfall, windspeed, wind direction, humidity, Dew point temperature, Local Pressure, Sea surface Pressure, Sunshine, Solar Radiation, Snowfall, Ground Temperature"

* weather2013 : Weather Data In Daejeon, 2013
* weather2014 : Weather Data In Daejeon, 2014
* weather2015 : Weather Data In Daejeon, 2015

```{r}
load(file = "../data/weather2013.rda")
head(weather2013, n = 5)
```

4.    Festival Data
: Festival Data In Daejeon from 2013 to 2015. Data is consisted of "Festival(Name of festival), Location(Location of festival), nearStation(bike station affected by festival), startDate(festival starting date time), endDate(festival ending date time)"
```{r}
load(file = "../data/festivalData.rda")
head(festivalData, n = 5)
```


## 3. Analysis

This package provides some functions that analyze bike usage pattern. Time and weather conditions were selected as factors affecting bicycle usage.

1.    getTop10Stations()
: This function presents top 10 stations that have most number of bike rental for 3 years.

```{r, fig.width=7,fig.height=8}
library(tashu)
getTop10Stations()
```

2.    getTop10Pathes()
: This function presents top 10 pathes that have mostly used for 3 years.
```{r, fig.width=7,fig.height=8}
library(tashu)
getTop10Pathes()
```

3.    getAmountOfRentalEachMonth()
: This function shows average amount of bike rental in each months.
```{r, fig.width=7,fig.height=8}
library(tashu)
getAmountOfRentalEachMonth()
```

4.    getAmountOfRentalEachDayOfWeek()
: This function shows bike usage pattern in each day of week.
```{r, fig.width=7,fig.height=8}
library(tashu)
getAmountOfRentalEachDayOfWeek()
```

5.    getUsageByTemperature()
: This function shows the change of bike usage pattern according to Temperature.
```{r, fig.width=7,fig.height=8}
library(tashu)
getUsageByTemperature()
```


## 4. Prediction
 This package provides function that predict the demand of bike rental using Random Forest. Users must go through the process of "generating training data → establishing a prediction model → inputing testing data and predict → confirming forecast results" for prediction.

1.    createTrainData(stationNum)
: This function generates training data for the random forest prediction model. This function preprocesses the bicycle rental history, weather, and festival data that occurred at "stationNum" stop in 2013 ~ 2014, you can generate training data with following code.
```{r}
#trainData <- createTrainData(1)
```

2.    createTestData(stationNum)
: This function generates testing data that would be used for prediction. Bike rental history at the "stationNum" stop, weather and festival data in 2015 are preprocessed and you can generate training data with following code.
 
```{r}
#testData <- createTestData(1)
```

3.    predictDemandOfBikesUsingRF(trainData, testData, isImportance, numOfTree, type)
: This function takes trainData and testData as parameters and performs prediction about amount of bike rental at stationNum stop. First, It implements the random forest prediction model with trainData and input testData to predict the demand of bike rental in 2015. And below source code is example.
 
```{r}
#resultData <- predictDemandOfBikesUsingRF(trainData, testData, numOfTree = 50)
```
