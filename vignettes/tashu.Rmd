---
title: "tashu : Analysis and Demand forecast for Public bicycles('Tashu') in Daejeon, South Korea"
author: "JiWon Min"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---
## 1. Introduction
  Major cities in the world operate public bicycle systems as green public transportation. The public bicycle system is leading to the effect of the dispersion of public transportation demand and the increase of the citizens' momentum. Daejeon City in South Korea also has operated a public bicycle system called "Tashu" since 2012 and is conducting research to increase utilization.
  As the public bicycle system expands, the scale of relocation work is also growing. If the relocation work is not done at the right time, there will be an unbalanced situation where there is no bike in station that rental is mainly made. In order to find the time when relocation work is required, It is necessary to analyze the bicycle rental history to grasp the usage patterns of the citizens. We can check The change of bicycle usage according to time, weather, and festival condition and predict the bicycle demand at each station.
  This package provides bicycle rental history data on Tashu from 2013 to 2015, analytic source code, and prediction for demand using random forest algorithm. 
  
 
 (현재 상황 - 공공 자전거 시스템을 도입하는 곳이 많다)
 세계 주요 도시는 녹색대중교통수단으로 공공 자전거 시스템을 운영하며 이는 대중교통 수요 분산, 시민들의 운동량 증대의 효과를 내고 있다.
 
 Major cities in the world operate public bicycle systems as green public transportation. Public bicycle system is leading to the effect of the dispersion of public transportation demand and the increase of the citizens' momentum.
 (문제 상황)
 공공 자전거 시스템에서 대여가 많이 이루어지는 정류소에 자전거가 없거나 반납이 많이 이루어지는 정류소에 반납할 자리가 없는 불균형 상황이 생길 수 있다. 이런 상황을 해소하기 위해선 자전거 재배치 작업이 사전에 이루어져야 한다. 공공 자전거 시스템이 커질 수록 재배치 작업의 로드 또한 커지고 있으며, 작업의 효율성을 높이기 위한 방안이 수립될 필요가 있다.
 
 
 (해결 방법 제안)
 자전거 대여 이력 분석을 통해 시민들의 자전거 사용 패턴을 파악하고 각 정류소의 수요를 대략적으로 어림잡을 수 있다. 자전거 대여량에 영향을 주는 요인들을 파악하여 그에 따른 자전거 대여량 변화를 확인한다.
 (해결 방법 소개)
 (해결 방법)
 (결과)

## 2. Data
1.    Tashu Data
: Bicycle rental history on Tashu from 2013 to 2015. Data is consisted of "RENT STATION, RENT DATE, RETURN STATION, RETURN DATE"
* tashu2013 : Rental history In 2013.
* tashu2014 : Rental history In 2014.
* tashu2015 : Rental history In 2015.
* tashuDataFor3year : Rental history from 2013 to 2015.

```{r}
load(file = "../data/tashu2013.rda")
head(tashu2013, n = 5)
```

2.    Tashu Station Data
: By 2014 there were 144 bicycle stations and a new one in 2015, currently operating 244 stations. In this study, only the existing data of 144 stop stations are considered. Data is consisted of "NUM(Number of station), KIOSKNUM(Number of Kiosk), DISTRICT(District where Station is located), Name(Name of station), LOCATION(Location of station), NUMOFBIKE_RACK(Number of Bike rack), GEODATA_lat(Latitude of station), GEODATA_lon(Longitude of station)"

* tashuStationData : data of 144 Stations on Tashu system. 
```{r}
load(file = "../data/tashuStationData.rda")
head(tashuStationData, n = 5)
```

3.    Weather Data
: Weather Data In Daejeon from 2013 to 2015. Data is consisted of "datetime, temperature, rainfall, windspeed, wind direction, humidity, Dew point temperature, Local Pressure, Sea surface Pressure, Sunshine, Solar Radiation, Snowfall, Ground Temperature"

* weather2013 : Weather Data In Daejeon, 2013
* weather2014 : Weather Data In Daejeon, 2014
* weather2015 : Weather Data In Daejeon, 2015

```{r}
load(file = "../data/weather2013.rda")
head(weather2013, n = 5)
```

4.    Festival Data
: Festival Data In Daejeon from 2013 to 2015. Data is consisted of "Festival(Name of festival), Location(Location of festival), nearStation(bike station affected by festival), startDate(festival starting date time), endDate(festival ending date time)"
```{r}
load(file = "../data/festivalData.rda")
head(festivalData, n = 5)
```



## 3. Analysis

대전 시민들의 자전거 사용 패턴을 확인하기 위한 분석을 수행하였다. 자전거 사용량에 영향을 주는 요인으로 시간, 기상 상태를 선정하였다. 그에 따른 자전거 사용량 변화를 확인하였다.
This package provide some functions that analyze bike usage pattern. Time and weather conditions were selected as factors affecting bicycle usage.

1.    getTop10Stations()
: This function presents top 10 stations that have most number of bike rental for 3 years.

```{r}
#library(Tashu)
#getHeavilyUsedStations()
```

1.    getTop10Pathes()
: This function presents top 10 pathes that have mostly used for 3 years.
```{r}
#library(Tashu)
#getTop10PathES()
```

1.    getAmountOfRentalEachMonth()
: This function show average amount of bike rental in each months.
```{r}
#library(Tashu)
#getAmountOfRentalEachMonth()
```

1.    getAmountOfRentalEachDayOfWeek()
: This function show bike usage pattern in each day of week.
```{r}
#library(Tashu)
#getAmountOfRentalEachMonth()
```

1.    getUsageByTemperature()
: This function show the change of bike usage pattern according to Temperature.
```{r}
#library(Tashu)
#getAmountOfRentalEachMonth()
```


## 4. Prediction
 이 패키지에선, 랜덤 포레스트를 이용한 자전거 사용량 예측을 예제로 제공한다. 사용자들은 n번 정류소의 자전거 대여량을 예측하기 위해서, "학습 데이터 생성 → 예측 모델 수립 → 테스트 데이터 대입 → 예측 결과 확인" 의 과정을 거쳐야 한다.

1.    createTrainData(stationNum)
: 이 함수는 랜덤 포레스트 예측 모델을 구현하기 위해 사용될 학습 데이터를 생성한다. 이 함수는 2013 ~ 2014 년도에 stationNum 정류소에서 일어난 자전거 대여 이력과 날씨, 축제 데이터를 전처리하여 다음과 같은 데이터 프레임을 만들어 반환한다.


2.    createTestData(stationNum)
: 이 함수는 구현된 예측 모델에게 예측을 위한 조건 데이터를 제공하는 테스트 데이터를 생성한다. 2015년도에 stationNum 정류소에서 일어난 자전거 대여 이력과 날씨, 축제 데이터를 전처리하여 다음과 같은 데이터 프레임을 만들어 반환한다.

3.    predictDemandOfBikesUsingRF(trainData, testData, isImportance, numOfTree, type)
: 이 함수는 trainData와 testData를 파라미터로 받아 stationNum 정류소에서의 자전거 사용량 예측을 전반적으로 수행하는 함수이다. trainData로 랜덤 포레스트 예측 모델을 구현한다. 그 후 테스트 데이터의 예측 결과 값을 
